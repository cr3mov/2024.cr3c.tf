import{m as r,C as e}from"./index.4a8d564d.js";window.Alpine=r;window.CTFd=e;r.data("notification",()=>({open:!1,notifications:[],getDate(t){const o=new Date(t),a={day:"2-digit",month:"short",timeZone:"UTC"},i={hour:"2-digit",minute:"2-digit",timeZoneName:"short",timeZone:"UTC"},s=new Intl.DateTimeFormat("en-GB",a),n=new Intl.DateTimeFormat("en-GB",i),c=s.format(o),d=n.format(o).replace(",","");return`${c} ${d}`},openModal(){if(Number(this.$store.unread_count.count)===0)return window.open("/notifications","_self");let t=e.events.counter.read.getLast();e.fetch(`/api/v1/notifications?since_id=${t}`).then(o=>o.json()).then(o=>{let a=o.data;setTimeout(()=>{this.open=!0},1);let i=e.events.counter.read.getAll();a.forEach(n=>{i.push(n.id)}),this.notifications=a.map(n=>({title:n.title,content:n.content,date:this.getDate(n.date)})),e.events.counter.read.setAll(i),e.events.counter.unread.readAll();let s=e.events.counter.unread.getAll().length;e.events.controller.broadcast("counter",{count:s}),r.store("unread_count",{count:s})})},init(){document.body.addEventListener("click",t=>{t.target.classList.value!=="notification__pop_up"&&t.target.classList.value!=="content__notification_pop_up"&&t.target.classList.value!=="header__notification_pop_up"&&t.target.classList.value!=="block__notification_pop_up"&&(this.open=!1)})}}));r.start();
